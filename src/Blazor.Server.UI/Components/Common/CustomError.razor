@using CleanArchitecture.Blazor.Application.Common.Exceptions
@using System.Net
<MudAlert Severity="MudBlazor.Severity.Warning">Oopsie! @statusCode: @message For more information, contact your system administrator </MudAlert>

@code {
    private string? message { get; set; }
    private string? statusCode { get; set; } = HttpStatusCode.InternalServerError.ToString();
    [EditorRequired][Parameter] public Exception Exception { get; set; } = default!;
    protected override Task OnInitializedAsync()
    {
        switch (Exception)
        {
            case CustomException e:
                statusCode = e.StatusCode.ToString();
                if (e.ErrorMessages is not null)
                {
                    message = string.Join(", ", e.ErrorMessages.ToArray());
                }
                break;
            default:
                if (Exception.InnerException != null)
                {
                    while (Exception.InnerException != null)
                    {
                        Exception = Exception.InnerException;
                    }
                }
                message = Exception.Message;
                break;
        }
        return base.OnInitializedAsync();
    }
}
